import{d as e,v as a,bB as t,r as s,a as r,o,c as l,w as n,h as d,b as u,k as i,t as c,e as m,f as p,F as f,l as _,B as y,m as v,j as b,p as g,bd as x,a4 as h,s as j,X as k,ae as I,b0 as w,g as z,x as C,ag as S}from"./index.0909ac6c.js";import{t as E,a as F}from"./tabs.b16c84eb.js";import{_ as R}from"./z-paging.1a5d6e51.js";import{_ as B}from"./u-button.a01fb808.js";import{_ as T}from"./u-empty.1075db88.js";import{b as V}from"./order.ef69829d.js";import{_ as H}from"./u-image.879031a5.js";import{_ as L}from"./u-count-down.9a1490e6.js";import{P as M}from"./index.5b25a2dc.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as D}from"./index.a7bc2788.js";import"./u-badge.2b611478.js";import"./u-sticky.c3d66a2b.js";import"./useTouch.93885aba.js";import"./u-icon.0b85921a.js";var N=$(e({__name:"order-card",props:{orderInfo:{default:{}}},emits:["refresh"],setup(e,{emit:x}){const h=e,j=a(0);t((()=>{const e=h.orderInfo.cancel_time,a=(new Date).getTime()/1e3;j.value=1e3*(e-a)}));const k=()=>{j.value=0,x("refresh")},I=()=>{v({url:`/bundle/pages/order_detail/index?id=${h.orderInfo.id}`})};return(a,t)=>{const v=b,x=s(r("u-image"),H),h=s(r("u-count-down"),L),w=g;return o(),l(v,{class:"card",onClick:y(I,["stop"])},{default:n((()=>[d(" Header Start "),u(v,{class:"card--header flex justify-between"},{default:n((()=>[u(v,{class:"order-sn"},{default:n((()=>[i("订单编号："+c(e.orderInfo.sn),1)])),_:1}),u(v,{class:"status"},{default:n((()=>[i(c(e.orderInfo.order_status_desc),1)])),_:1})])),_:1}),d(" Header End "),d(" Main Start "),(o(!0),m(f,null,p(e.orderInfo.order_course,(a=>(o(),l(v,{key:a.id,class:"card--main flex"},{default:n((()=>[u(x,{src:a.course_snap.cover,width:"250",height:"160",borderRadius:"10"},null,8,["src"]),u(v,{class:"ml-[20rpx] order-text"},{default:n((()=>[u(v,{class:"order-text--name line-2"},{default:n((()=>[i(c(a.course_snap.name),1)])),_:2},1024),u(v,{class:"mt-[19rpx]"},{default:n((()=>[u(M,{content:e.orderInfo.order_amount,mainSize:"36rpx",minorSize:"34rpx",fontWeight:"500"},null,8,["content"])])),_:1})])),_:2},1024)])),_:2},1024)))),128)),d(" Main End "),d(" Footer Start "),u(v,{class:"card--footer flex justify-between items-center"},{default:n((()=>[d(" Left Tips "),u(v,{class:"primary"},{default:n((()=>[j.value?(o(),m(f,{key:0},[j.value>=0?(o(),l(v,{key:0,class:"flex items-center"},{default:n((()=>[u(h,{timestamp:j.value,format:"mm:ss","separator-size":26,onEnd:k,color:"#2073F4",class:"text-primary font-normal text-sm"},null,8,["timestamp"]),u(w,{class:"ml-[10rpx] primaryColor"},{default:n((()=>[i("后自动取消")])),_:1})])),_:1})):d("v-if",!0)],64)):d("v-if",!0)])),_:1}),d(" Right Button "),u(v,null,{default:n((()=>[_(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3}),d(" Footer End ")])),_:3},8,["onClick"])}}}),[["__scopeId","data-v-4bf2a5d9"]]);const P=x((function(){v({url:"/pages/login/login"})}),2e3);var Q=$(e({__name:"order-list",props:{type:{default:1},i:{default:0},index:{default:0}},setup(e){const t=e,c=h(),_=a([]),y=j(),v=k((()=>c.token)),g=()=>{console.log(1),y.value.refresh()},x=a(!0);I((()=>t.index),(async()=>{var e;await w(),t.i==t.index&&z(x)&&(x.value=!1,null==(e=y.value)||e.reload())}),{immediate:!0});const S=async(e,a)=>{try{const{lists:s}=await V({page_no:e,page_size:a,type:t.type});y.value.complete(s)}catch(s){console.log("下拉加载",s),y.value.complete(!1)}};return C((async()=>{await w(),y.value.refresh()})),(a,t)=>{const c=s(r("z-paging"),R),x=s(r("u-button"),B),h=b,j=s(r("u-empty"),T);return o(),m(f,null,[z(v)?(o(),l(c,{key:0,"auto-show-back-to-top":"",auto:e.i==e.index,ref_key:"paging",ref:y,modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),"data-key":e.i,onQuery:S,fixed:!1,height:"100%"},{default:n((()=>[(o(!0),m(f,null,p(_.value,((e,a)=>(o(),m(f,{key:e.id},[d(" 订单卡片 "),u(N,{orderInfo:e,onRefresh:g},{default:n((()=>[u(D,{orderId:null==e?void 0:e.id,cancel:e.cancel_btn,evaluate:e.comment_btn,pay:e.pay_btn,del:e.del_btn,onRefresh:g},null,8,["orderId","cancel","evaluate","pay","del"])])),_:2},1032,["orderInfo"])],64)))),128))])),_:1},8,["auto","modelValue","data-key"])):d("v-if",!0),d(" 未登录 "),z(v)?d("v-if",!0):(o(),l(h,{key:1,class:"empty"},{default:n((()=>[u(j,{src:"/static/images/empty/order.png",text:"您还没有登录～",mode:"data","icon-size":300,"margin-top":"300",color:"#888888"},{bottom:n((()=>[u(h,{class:"m-t-30"},{default:n((()=>[u(x,{onClick:z(P),shape:"circle",ripple:!0,"hair-line":!1,type:"info"},{default:n((()=>[i(" 去登录")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["src"])])),_:1}))],64)}}}),[["__scopeId","data-v-0cef7c60"]]);var U=$(e({__name:"index",setup(e){const t=a([{name:"全部",type:0},{name:"待支付",type:1},{name:"已完成",type:2},{name:"已关闭",type:3}]),d=a(0),i=e=>{d.value=Number(e)};return S((e=>{d.value=1*(null==e?void 0:e.type)||0})),(e,a)=>{const c=b,_=s(r("tab"),E),y=s(r("tabs"),F);return o(),l(c,{class:"order-list"},{default:n((()=>[u(y,{current:d.value,onChange:i,height:"80","bar-width":"60","is-scroll":!1},{default:n((()=>[(o(!0),m(f,null,p(t.value,((e,a)=>(o(),l(_,{key:a,name:e.name},{default:n((()=>[u(c,{class:"orderList"},{default:n((()=>[u(Q,{type:e.type,i:a,index:d.value},null,8,["type","i","index"])])),_:2},1024)])),_:2},1032,["name"])))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-b063c9b6"]]);export{U as default};
