import{d as e,a3 as a,v as t,ae as l,X as s,bd as u,be as o,r as i,a as r,o as n,c,w as d,b as f,g as p,k as m,t as v,bf as _,D as b,bg as y,p as x,j as h,b9 as g,a_ as I,bb as k,aZ as w,bh as D,h as j,e as C,B as T,F as z,q as F,a4 as $,bi as S,H as E,ag as R,x as N,y as V,z as B,A as M,N as A,O,Q as P,af as U,m as H}from"./index.0909ac6c.js";import{_ as q}from"./u-navbar.1ad76ddf.js";import{_ as G}from"./u-sticky.c3d66a2b.js";import{_ as Q}from"./u-button.a01fb808.js";import{t as W,a as X}from"./tabs.b16c84eb.js";import{_ as Z}from"./u-empty.1075db88.js";import{_ as J}from"./u-icon.0b85921a.js";import{c as K,a as L,d as Y}from"./goods.771ae366.js";import{_ as ee}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as ae}from"./mp-html.427f03d4.js";import{_ as te}from"./u-popup.7b59164b.js";import{C as le}from"./index.dda398ef.js";import"./u-badge.2b611478.js";import"./useTouch.93885aba.js";var se=ee(e({__name:"l-audio",props:{src:{default:""},cataId:{default:0},courseId:{default:0},courseDetailInfo:{default:()=>{}},initialTime:{default:0}},emits:["refresh"],setup(e,{emit:g}){const I=e;let k=a({});const w=t(0),D=t(0),j=t(!1),C=t(!1);t(!1),l((()=>I.src),(e=>{const a=_();a.autoplay=!0,a.src=e,a.volume=1,a.startTime=I.initialTime,k=a,k.onCanplay((e=>{const a=setInterval((()=>{console.log("定时器循环"+k.duration),0!=k.duration&&(clearInterval(a),D.value=k.duration,setTimeout((()=>{k.play()}),0))}),500)})),k.onPlay((e=>{j.value=!0})),k.onTimeUpdate((e=>{M(),w.value=k.currentTime})),k.onWaiting((e=>{console.log("加载中")})),k.onPause((e=>{console.log("音频停止"),j.value=!1})),k.onEnded((e=>{console.log("播放完成"),j.value=!1})),k.onError((e=>{console.log("播放错误"),j.value=!1}))}),{immediate:!0}),l((()=>I.initialTime),(e=>{e>0&&uni.$u.toast("将跳转至上次播放的位置开始播放")}),{immediate:!0});const T=s((()=>{const e=w.value;return P(e)||"00:00"})),z=s((()=>{const e=D.value;return 0!=e&&O(),P(e)||"00:00"})),F=s((()=>w.value/D.value*100)),$=s((()=>I.courseDetailInfo.catalogue_list)),S=e=>{C.value=!1,w.value=e.detail.value/100*D.value,k.seek(w.value)},E=e=>{C.value=!0},R=()=>{j.value?O():A(),j.value=!j.value},N=()=>$.value.findIndex((e=>e.id==I.cataId)),V=()=>{const e=N();e+1!=$.value.length?g("refresh",$.value[e+1]):uni.$u.toast("已经是最后一章！")},B=()=>{const e=N();e-1<0?uni.$u.toast("已经是第一章！"):g("refresh",$.value[e-1])},M=u((()=>{K({catalogue_id:I.cataId,schedule:1*Math.floor(w.value)})}),2e3),A=()=>{k.play()},O=()=>{k.pause()},P=e=>{let a,t=parseInt(e/60/60%24);t=t<10?"0"+t:t;let l=parseInt(e/60%60);l=l<10?"0"+l:l;let s=parseInt(e%60);return s=s<10?"0"+s:s,a=`${"00"==t?"":t+":"}${l}:${s}`,a};return o((()=>{k.destroy(),console.log("组件销毁！！！！")})),(a,t)=>{const l=b,s=y,u=x,o=h,_=i(r("u-icon"),J);return n(),c(o,{class:"px-[68rpx] audio"},{default:d((()=>[f(l,{class:"w-full h-[330rpx] rounded-lg",src:e.courseDetailInfo.cover},null,8,["src"]),f(s,{value:p(F),activeColor:"#2073F4",backgroundColor:"#B1CFFF","block-color":"#2073F4",onChange:S,onChanging:E,"block-size":12,min:"0",max:"100"},null,8,["value"]),f(o,{class:"flex justify-between mt-[20rpx]"},{default:d((()=>[f(u,null,{default:d((()=>[m(v(p(T)),1)])),_:1}),f(u,null,{default:d((()=>[m(v(p(z)),1)])),_:1})])),_:1}),f(o,{class:"flex justify-center items-center"},{default:d((()=>[f(o,{onClick:B},{default:d((()=>[f(_,{name:"rewind-left-fill",size:"32"})])),_:1}),f(o,{class:"mx-[30rpx] control w-[64rpx] h-[64rpx] bg-primary rounded-full flex items-center justify-center text-white pl-[5rpx]",onClick:R},{default:d((()=>[j.value?(n(),c(_,{key:0,name:"pause",size:"32"})):(n(),c(_,{key:1,name:"play-right-fill",size:"32"}))])),_:1}),f(o,{onClick:V},{default:d((()=>[f(_,{name:"rewind-right-fill",size:"32"})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-26e8e225"]]);const ue=e({__name:"l-video",props:{src:{type:String,default:""},initialTime:{type:Number,default:0},cataId:{type:Number,default:-1},courseId:{type:Number,default:-1},time:{type:String,default:""}},emits:["end","pause"],setup(e,{emit:a}){const s=e,o=I(),i=g("myVideo",o),r=t(0);l((()=>s.initialTime),(e=>{r.value=e,e>0&&(uni.$u.toast("即将跳转到上次播放的位置"),setTimeout((()=>{i.play()}),2e3))}),{immediate:!0});const p=e=>{a("pause"),m()},m=()=>{K({catalogue_id:s.cataId,schedule:1*r.value})},v=u(m,4e3),_=e=>{r.value=Math.round(e.detail.currentTime),v()},b=()=>{r.value=0,a("end")};return(a,t)=>{const l=k,s=h;return n(),c(s,{class:"w-full"},{default:d((()=>[f(l,{class:"w-full h-[400rpx]",id:"myVideo",src:e.src,controls:"","initial-time":r.value,duration:e.time,onPause:p,onTimeupdate:_,onEnded:b},null,8,["src","initial-time","duration"])])),_:1})}}}),oe=e({__name:"I-text",props:{courseData:{default:{name:"ces"}},cataId:{default:0},courseId:{default:0},courseDetailInfo:{default:{}}},setup(e){const a=e;return w((()=>{console.log("Mounted - courseData.name:",a.courseData.name)})),D((()=>{console.log("Updated - courseData.name:",a.courseData.name)})),(a,t)=>{const l=h,s=i(r("mp-html"),ae);return n(),c(l,{class:"pt-[150rpx] mx-[20rpx]"},{default:d((()=>[j("图文课程顶部显示标题"),f(l,{class:"course-info"},{default:d((()=>[j(" 课程名称 "),j(' <view class="text-xl font-medium flex-1"> {{ courseData.name }} </view> '),j(" 介绍 "),f(l,{class:"text-muted mt-[18rpx] text-sm"},{default:d((()=>{var a,t,l;return[m(v(null==(a=e.courseDetailInfo)?void 0:a.create_time)+" "+v(null==(l=null==(t=e.courseDetailInfo)?void 0:t.teacher)?void 0:l.name),1)]})),_:1})])),_:1}),j(" 图文 "),f(l,{class:"bg-white p-[30rpx]"},{default:d((()=>[f(s,{content:e.courseData.content},null,8,["content"])])),_:1})])),_:1})}}});var ie=ee(e({__name:"ITbottom",props:{courseDetailInfo:{type:Object,default:()=>{}},cateId:{type:[Number,String],default:0}},emits:["refresh"],setup(e,{emit:a}){const l=e,u=t(!1),o=()=>{u.value=!0},c=s((()=>l.courseDetailInfo.catalogue_list)),p=e=>{a("refresh",e),u.value=!1},v=()=>c.value.findIndex((e=>e.id==l.cateId)),_=()=>{const e=v();e-1<0?uni.$u.toast("已经是第一章！"):p(c.value[e-1])},b=()=>{const e=v();e+1!=c.value.length?p(c.value[e+1]):uni.$u.toast("已经是最后一章！")};return(a,t)=>{const l=i(r("u-icon"),J),s=x,c=h,v=F,y=i(r("u-popup"),te);return n(),C(z,null,[f(c,{class:"flex h-[150rpx] items-center",style:{"border-top":"1px solid #e2e2e2"}},{default:d((()=>[f(c,{class:"w-1/3 text-center",onClick:_},{default:d((()=>[f(l,{name:"arrow-left",color:"#2979ff",size:"28"}),f(s,null,{default:d((()=>[m("上一章")])),_:1})])),_:1}),f(c,{class:"w-1/3 text-center mid",onClick:T(o,["stop"])},{default:d((()=>[m("目录")])),_:1},8,["onClick"]),f(c,{class:"w-1/3 text-center",onClick:b},{default:d((()=>[f(s,null,{default:d((()=>[m("下一章")])),_:1}),f(l,{name:"arrow-right",color:"#2979ff",size:"28"})])),_:1})])),_:1}),f(y,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),"safe-area-inset-bottom":"",mode:"bottom",height:"800rpx","border-radius":"20",closeable:""},{default:d((()=>[f(c,null,{default:d((()=>[f(c,{class:"h-[100rpx] text-center leading-[100rpx] text-2xl font-medium"},{default:d((()=>[m("目录")])),_:1}),f(c,{class:"h-[600rpx]"},{default:d((()=>[f(v,{"scroll-y":"",class:"h-full"},{default:d((()=>[j(' <course-catalogue\n                        :list="courseDetailInfo.courseCatalogues"\n                        :type="courseDetailInfo.type"\n                        :status="courseDetailInfo.purchased"\n                        :cateId="cateId"\n                        @refresh="handleRefresh"\n                    >\n                    </course-catalogue> '),f(le,{list:e.courseDetailInfo.catalogue_list,type:e.courseDetailInfo.type,status:e.courseDetailInfo.course_status,cateId:e.cateId,onRefresh:p},null,8,["list","type","status","cateId"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-20f0205e"]]);var re=ee(e({__name:"index",setup(e){const a=t({id:0,course_id:0,name:"",fee_type:0,cover:"",content:"",schedule:0,duration:""}),l=t({course_status:0,catalogue_list:[]}),u=t(!0),o=t(!1),_=t(""),b=t(""),y=t(),x=t(0),g=t(0),I=t(0),k=t(!1),w=$();s((()=>w.token));const D=s((()=>e=>{switch(e){case 1:return 0;case 2:case 3:return 400}})),T=async()=>{A({title:"载入中",mask:!0});try{o.value=!1;const e=await Y({id:b.value,course_id:_.value});a.value=e}catch(e){o.value=!0,console.log(e)}O()},F=e=>{e.id!=b.value&&(y.value=e,_.value=e.course_id,b.value=e.id,T(),P({scrollTop:0,duration:100}))},J=()=>{U()},K=()=>{k.value=!1};let ee=0;return S((({scrollTop:e})=>{if(k.value=!(e<ee),ee=e,1==g.value){const a=E(100);I.value=e/a>1?1:e/a}})),R((e=>{g.value=e.type,1!=g.value&&(I.value=1),b.value=e.cate_id,_.value=e.course_id})),N((()=>{(async()=>{try{l.value=await L({id:_.value})}catch(e){console.log("获取课程详情=> ",e),u.value=!1}})(),T()})),(e,t)=>{const s=h,_=i(r("u-navbar"),q),I=i(r("u-sticky"),G),w=i(r("u-button"),Q),T=i(r("tab"),W),$=i(r("tabs"),X),S=i(r("u-empty"),Z);return n(),C(z,null,[V(f(s,{class:"study-course safeArea",onClick:K},{default:d((()=>[f(s,null,{default:d((()=>[j(" BGpercent "),f(_,{"is-back":1,background:{background:"rgba(255,255,255,1)"},"border-bottom":!1,immersive:1==g.value},{default:d((()=>[f(s,{class:"w-[400rpx] overflow-hidden whitespace-nowrap text-ellipsis",style:M([{color:"rgba(0,0,0,1)"},{"min-width":"0"}])},{default:d((()=>{var e,t;return[m(v((null==(e=y.value)?void 0:e.name)||(null==(t=a.value)?void 0:t.name)),1)]})),_:1},8,["style"])])),_:1},8,["background","immersive"])])),_:1}),j(" 课程信息 "),f(s,{class:"course bg-white"},{default:d((()=>[j(" 音频 "),2!=g.value||o.value?j("v-if",!0):(n(),c(s,{key:0,class:"h-[600rpx]"},{default:d((()=>[f(I,{enable:!0,"offset-top":0,"h5-nav-height":0},{default:d((()=>[f(s,{class:"p-[40rpx]"},{default:d((()=>[b.value==a.value.id?(n(),c(se,{key:0,src:a.value.content,"cata-id":a.value.id,"course-id":a.value.course_id,"initial-time":a.value.schedule,"course-detail-info":l.value,onRefresh:F},null,8,["src","cata-id","course-id","initial-time","course-detail-info"])):j("v-if",!0)])),_:1})])),_:1})])),_:1})),j(' <view v-else class="flex w-full h-[400rpx] justify-center items-center">\n                    <u-button type="primary" @click="backToBuy" shape="circle" class=""\n                        >购买课程</u-button\n                    >\n                </view> '),j(" 视频 "),3!=g.value||o.value?j("v-if",!0):(n(),c(s,{key:1,class:"h-[400rpx] bg-black"},{default:d((()=>[b.value==a.value.id?(n(),c(ue,{key:0,src:a.value.content,"initial-time":a.value.schedule,time:a.value.duration,"cata-id":a.value.id,"course-id":a.value.course_id},null,8,["src","initial-time","time","cata-id","course-id"])):j("v-if",!0)])),_:1})),1!=g.value||o.value?j("v-if",!0):(n(),c(s,{key:2},{default:d((()=>[b.value==a.value.id?(n(),c(oe,{key:0,courseData:a.value,"cata-id":a.value.id,"course-id":a.value.course_id,"course-detail-info":l.value},null,8,["courseData","cata-id","course-id","course-detail-info"])):j("v-if",!0)])),_:1})),o.value?(n(),c(s,{key:3,class:"flex w-full h-[400rpx] justify-center items-center"},{default:d((()=>[f(w,{type:"primary",onClick:J,shape:"circle",class:""},{default:d((()=>[m("购买课程")])),_:1})])),_:1})):j("v-if",!0)])),_:1}),j("图文目录"),1==g.value?V((n(),c(s,{key:0,class:"bottom-0 px-[20rpx] safeArea fixed w-full bg-white"},{default:d((()=>[f(ie,{"cate-id":b.value,"course-detail-info":l.value,onRefresh:F},null,8,["cate-id","course-detail-info"])])),_:1},512)),[[B,!k.value]]):j("v-if",!0),j(" 课程目录 "),1!=g.value?(n(),c(s,{key:1,class:"mt-[30rpx]"},{default:d((()=>[f($,{current:x.value,fontSize:"32",height:"100","bar-width":"60",inactiveColor:"#888888",top:p(D)(g.value),isFixed:"",tabsStyle:{"border-bottom":"1px solid #F6F6F6"},barStyle:{bottom:"-2rpx"},barHeight:"6"},{default:d((()=>[f(T,{name:"目录",i:1,index:x.value},{default:d((()=>[f(s,{style:{"min-height":"700rpx"}},{default:d((()=>[f(le,{list:l.value.catalogue_list,type:l.value.type,status:l.value.course_status,cateId:b.value,onRefresh:F},null,8,["list","type","status","cateId"])])),_:1})])),_:1},8,["index"])])),_:1},8,["current","top"])])),_:1})):j("v-if",!0),j(" Main End ")])),_:1},512),[[B,u.value]]),j(" empty Start "),V(f(s,{class:"empty"},{default:d((()=>[f(S,{text:"抱歉，该课程不存在~",src:"/static/images/empty/collection.png","icon-size":300,color:"#888888"},{bottom:d((()=>[f(s,{class:"empty-bottom"},{default:d((()=>[f(w,{onClick:t[0]||(t[0]=e=>{H({url:"/pages/index/index"})}),shape:"circle",ripple:!0,"hair-line":!1,type:"primary"},{default:d((()=>[m(" 去看看其它")])),_:1})])),_:1})])),_:1},8,["src"])])),_:1},512),[[B,!u.value]]),j(" empty End "),j(" 购买课程弹窗 Start "),j(' <u-popup v-model="buyCourse" mode="center" borderRadius="14" :mask-close-able="false">\n        <view class="course-pop text-center">\n            <view class="text-lg font-medium normal pt-[45rpx] pb-[40rpx]"\n                >抱歉，您还未加入过该课程</view\n            >\n            <view class="flex justify-between mt-[60rpx]">\n                <u-button\n                    @click="handleOrder"\n                    class="flex-1"\n                    :ripple="true"\n                    shape="circle"\n                    :hair-line="false"\n                    type="primary"\n                    >去购买</u-button\n                >\n                <u-button\n                    @click="buyCourse = false"\n                    class="flex-1 m-l-30"\n                    :ripple="true"\n                    shape="circle"\n                    :hair-line="false"\n                    type="gary"\n                    >取消</u-button\n                >\n            </view>\n        </view>\n    </u-popup> '),j(" 购买课程弹窗 End ")],64)}}}),[["__scopeId","data-v-674377f8"]]);export{re as default};
