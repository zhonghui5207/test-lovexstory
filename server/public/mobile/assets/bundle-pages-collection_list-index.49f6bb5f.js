import{H as t,bx as e,o as s,c as i,w as a,b as o,A as l,B as n,l as h,e as d,f as c,k as u,t as r,F as p,h as m,j as f,by as v,bz as b,d as g,s as y,v as w,a3 as x,bA as k,r as _,a as C,b7 as W,g as X,a1 as B}from"./index.0909ac6c.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as j}from"./z-paging.1a5d6e51.js";import{C as A}from"./index.c8eeccc8.js";import"./u-image.879031a5.js";import"./u-icon.0b85921a.js";import"./index.5b25a2dc.js";var E=$({name:"u-swipe-action",emits:["click","content-click","open","close"],props:{index:{type:[Number,String],default:""},btnWidth:{type:[String,Number],default:180},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},bgColor:{type:String,default:"#ffffff"},vibrateShort:{type:Boolean,default:!1},options:{type:Array,default:()=>[]}},watch:{show:{immediate:!0,handler(t,e){t?this.open():this.close()}}},data(){return{moveX:0,scrollX:0,status:!1,movableAreaWidth:0,elId:this.$u.guid(),showBtn:!1}},computed:{movableViewWidth(){return this.movableAreaWidth+this.allBtnWidth+"px"},innerBtnWidth(){return t(this.btnWidth)},allBtnWidth(){return t(this.btnWidth)*this.options.length},btnStyle(){return t=>(t.width=this.btnWidth+"rpx",t)}},mounted(){this.getActionRect()},methods:{btnClick(t){this.status=!1,this.$emit("click",this.index,t)},change(t){this.scrollX=t.detail.x},close(){this.moveX=0,this.status=!1},open(){this.disabled||(this.moveX=-this.allBtnWidth,this.status=!0)},touchend(){this.moveX=this.scrollX,this.$nextTick((function(){0==this.status?this.scrollX<=-this.allBtnWidth/4?(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent(),this.vibrateShort&&e()):(this.moveX=0,this.status=!1,this.emitCloseEvent()):this.scrollX>3*-this.allBtnWidth/4?(this.moveX=0,this.$nextTick((()=>{this.moveX=101})),this.status=!1,this.emitCloseEvent()):(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent())}))},emitOpenEvent(){this.$emit("open",this.index)},emitCloseEvent(){this.$emit("close",this.index)},touchstart(){},getActionRect(){this.$uGetRect(".u-swipe-action").then((t=>{this.movableAreaWidth=t.width,this.$nextTick((()=>{this.showBtn=!0}))}))},contentClick(){1==this.status&&(this.status="close",this.moveX=0),this.$emit("content-click",this.index)}}},[["render",function(t,e,g,y,w,x){const k=f,_=v,C=b;return s(),i(k,{class:""},{default:a((()=>[o(C,{class:"u-swipe-action",style:l({backgroundColor:g.bgColor})},{default:a((()=>[o(_,{class:"u-swipe-view",onChange:x.change,onTouchend:x.touchend,onTouchstart:x.touchstart,direction:"horizontal",disabled:g.disabled,x:w.moveX,style:l({width:x.movableViewWidth?x.movableViewWidth:"100%"})},{default:a((()=>[o(k,{class:"u-swipe-content",onClick:n(x.contentClick,["stop"])},{default:a((()=>[h(t.$slots,"default",{},void 0,!0)])),_:3},8,["onClick"]),w.showBtn?(s(!0),d(p,{key:0},c(g.options,((t,e)=>(s(),i(k,{class:"u-swipe-del",onClick:n((t=>x.btnClick(e)),["stop"]),style:l([x.btnStyle(t.style)]),key:e},{default:a((()=>[o(k,{class:"u-btn-text"},{default:a((()=>[u(r(t.text),1)])),_:2},1024)])),_:2},1032,["onClick","style"])))),128)):m("v-if",!0)])),_:3},8,["onChange","onTouchend","onTouchstart","disabled","x","style"])])),_:3},8,["style"])])),_:3})}],["__scopeId","data-v-d0fdd334"]]);const S=g({__name:"index",setup(t){const e=y(),l=w([]),n=x([{text:"删除",style:{backgroundColor:"#dd524d"}}]),h=async(t,s)=>{const{lists:i}=await k({page_no:t,page_size:s});i.forEach((t=>{t.show=!1})),e.value.complete(i)},u=async t=>{try{await W({id:X(l)[t].id,collect:0}),e.value.reload()}catch(s){console.log("收藏报错=>",s)}};return(t,r)=>{const m=B,v=_(C("u-swipe-action"),E),b=_(C("z-paging"),j),g=f;return s(),i(g,{class:"collection mt-4"},{default:a((()=>[o(b,{ref_key:"paging",ref:e,modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=t=>l.value=t),onQuery:h,fixed:!1,height:"100%","use-page-scroll":""},{default:a((()=>[(s(!0),d(p,null,c(l.value,((t,e)=>(s(),i(v,{show:t.show,index:e,key:t.id,onClick:u,options:n},{default:a((()=>[o(m,{url:`/pages/course_detail/index?id=${t.id}`,"hover-class":"none"},{default:a((()=>[o(A,{list:t,type:"card"},null,8,["list"])])),_:2},1032,["url"])])),_:2},1032,["show","index","options"])))),128))])),_:1},8,["modelValue"])])),_:1})}}});export{S as default};
