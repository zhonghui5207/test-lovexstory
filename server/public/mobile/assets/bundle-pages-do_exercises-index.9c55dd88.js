import{d as e,v as a,X as l,r as s,a as t,o as u,c as n,w as i,b as r,k as o,t as c,g as d,h as f,e as v,f as p,C as x,bO as m,F as _,j as y,D as w,bc as h,q as b,bP as k,s as g,ag as j,aZ as C,b0 as V,a7 as L,x as T,bu as E,m as F,N as I,O,az as z,af as N,p as P}from"./index.0909ac6c.js";import{u as A}from"./useTouch.93885aba.js";import{_ as U}from"./u-icon.0b85921a.js";import{_ as R}from"./u-button.a01fb808.js";import{e as S,f as X}from"./question_bank.3092fafb.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";var q=$(e({__name:"item",props:["modelValue","isLast"],emits:["update:modelValue","toNext"],setup(e,{expose:g,emit:j}){const C=e,V=a(!1),L=a([]),T=l({get:()=>(L.value=C.modelValue.points.split(/[(\r\n)\r\n]+/),C.modelValue),set(e){j("update:modelValue",e)}}),E=k((async()=>{S({topic_id:T.value.id,answer:T.value.user_answer})}),500),F=()=>{V.value=!0};return g({showAnswer:F}),(a,l)=>{const k=y,g=w,j=s(t("u-icon"),U),C=h,I=b,O=s(t("u-button"),R);return u(),n(k,{class:"h-full flex flex-col"},{default:i((()=>[r(k,{class:"flex-1 min-h-0"},{default:i((()=>[r(I,{class:"h-full","scroll-y":"true"},{default:i((()=>[r(k,{class:"bg-white p-[30rpx]"},{default:i((()=>[r(k,null,{default:i((()=>[o(c(d(T).stem),1)])),_:1}),r(k,{class:"mt-[30rpx]"},{default:i((()=>[d(T).illustration?(u(),n(g,{key:0,mode:"widthFix",class:"w-full rounded-lg",src:d(T).illustration},null,8,["src"])):f("v-if",!0)])),_:1}),r(k,{class:"option mt-[60rpx]"},{default:i((()=>[(u(!0),v(_,null,p(d(T).option,((e,a)=>(u(),n(k,{class:"optionItem flex items-center mb-[40rpx]",key:a,onClick:e=>(async e=>{if(!V.value){if(T.value.hasOwnProperty("user_answer")||(T.value.user_answer=[]),2==T.value.type)if(T.value.user_answer.includes(e)){const a=T.value.user_answer.findIndex((a=>a==e));console.log(a),T.value.user_answer.splice(a,1)}else T.value.user_answer.push(e);1==T.value.type&&(T.value.user_answer[0]=e),E()}})(a)},{default:i((()=>{var l,s;return[r(k,{class:x(["w-[76rpx] h-[76rpx] flex items-center justify-center head flex-none",{"head--active":(null==(l=d(T).user_answer)?void 0:l.includes(a))&&!V.value,"head--yourAnswer":(null==(s=d(T).user_answer)?void 0:s.includes(a))&&V.value,"head--trueAnswer":d(T).answer.includes(a)&&V.value}])},{default:i((()=>[o(c(d(m)(a)),1)])),_:2},1032,["class"]),r(k,{class:"content ml-2 flex-1 break-all"},{default:i((()=>[o(c(e),1)])),_:2},1024)]})),_:2},1032,["onClick"])))),128))])),_:1}),V.value?(u(),n(k,{key:0,class:"flex mt-[40rpx]"},{default:i((()=>[r(k,{class:"flex-1 text-xl text-error"},{default:i((()=>{var e;return[o("你的答案："+c((null==(e=d(T).user_answer)?void 0:e.map((e=>d(m)(e))).join(","))||"空"),1)]})),_:1}),r(k,{class:"flex-1 text-xl text-success"},{default:i((()=>{var e;return[o("正确答案："+c(null==(e=d(T).answer)?void 0:e.map((e=>d(m)(e))).join(",")),1)]})),_:1})])),_:1})):f("v-if",!0)])),_:1}),V.value?(u(),n(k,{key:0,class:"mt-[20rpx] bg-white p-[30rpx]"},{default:i((()=>[r(k,{class:"title text-xl font-medium"},{default:i((()=>[o("难度")])),_:1}),r(k,{class:"flex justify-around mt-[30rpx]"},{default:i((()=>[r(k,{class:x(["text-info",{"text-[#FEC617]":1==d(T).difficulty}])},{default:i((()=>[r(j,{size:"56",name:"star-fill"}),r(k,null,{default:i((()=>[o("简单")])),_:1})])),_:1},8,["class"]),r(k,{class:x(["text-info",{"text-[#FEC617]":2==d(T).difficulty}])},{default:i((()=>[r(j,{size:"56",name:"star-fill"}),r(k,null,{default:i((()=>[o("中等")])),_:1})])),_:1},8,["class"]),r(k,{class:x(["text-info",{"text-[#FEC617]":3==d(T).difficulty}])},{default:i((()=>[r(j,{size:"56",name:"star-fill"}),r(k,null,{default:i((()=>[o("困难")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})):f("v-if",!0),V.value?(u(),n(k,{key:1,class:"mt-[20rpx] bg-white p-[30rpx]"},{default:i((()=>[r(k,{class:"title text-xl font-medium"},{default:i((()=>[o("题目解析")])),_:1}),r(k,{class:"mt-[30rpx]"},{default:i((()=>[r(C,{class:"break-all",nodes:d(T).analysis},null,8,["nodes"])])),_:1})])),_:1})):f("v-if",!0),V.value&&d(T).points?(u(),n(k,{key:2,class:"mt-[20rpx] bg-white p-[30rpx]"},{default:i((()=>[r(k,{class:"title text-xl font-medium"},{default:i((()=>[o("考点")])),_:1}),r(k,{class:"mt-[30rpx] break-all"},{default:i((()=>[(u(!0),v(_,null,p(L.value,((e,a)=>(u(),n(k,{class:"pointItem mb-2",key:a},{default:i((()=>[""!=e?(u(),n(k,{key:0},{default:i((()=>[o(c(e),1)])),_:2},1024)):f("v-if",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),r(k,{class:"px-[30rpx] pt-[20rpx] bottomBtn bg-white shadow"},{default:i((()=>[V.value?f("v-if",!0):(u(),n(O,{key:0,type:"primary",shape:"circle",onClick:F},{default:i((()=>[o("显示答案")])),_:1})),V.value&&!e.isLast?(u(),n(O,{key:1,type:"primary",shape:"circle",onClick:l[0]||(l[0]=e=>a.$emit("toNext"))},{default:i((()=>[o("下一题")])),_:1})):f("v-if",!0),V.value&&e.isLast?(u(),n(O,{key:2,type:"primary",shape:"circle",onClick:l[1]||(l[1]=e=>a.$emit("toNext"))},{default:i((()=>[o("最后一题")])),_:1})):f("v-if",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-06506918"]]);var B=$(e({__name:"index",setup(e){const l=g(),s=a(0),{touchStart:t,touchMove:d,touch:f}=A(),m=a([]),w=a(!1),h=a(0),b=a("answer"),k=a(!0),U=e=>{w.value=!0,t(e)},R=e=>{w.value&&d(e)},S=()=>{if(!w.value)return;if("horizontal"===f.direction&&f.offsetX>=50){let e;const a=m.value.length,l=s.value;f.deltaX<=0?l>=a-1?b.value.includes("analysis")?(E({title:"已经是最后一题了",icon:"none"}),e=l):(B(),e=l):e=l+1:e=l<=0?l:l-1,V((()=>{s.value=e}))}w.value=!1},$=()=>{let e;const a=m.value.length,l=s.value;l>=a-1?b.value.includes("analysis")?(E({title:"已经是最后一题了",icon:"none"}),e=l):(B(),e=l):e=l+1,V((()=>{s.value=e}))},B=()=>{F({url:`/bundle/pages/answer_sheet/index?id=${h.value}`})},D=()=>{z({title:"提示",content:"确定要退出练习？退出后未完成的练习会保存在练习历史中",success:function(e){e.confirm?N():e.cancel&&window.history.pushState(null,"",document.URL)}})};return j((async e=>{h.value=e.id,e.hasOwnProperty("type")&&(b.value=e.type||""),e.hasOwnProperty("index")&&(s.value=e.index-1),setTimeout((()=>{b.value.includes("analysis")&&(k.value=!1,l.value.forEach((e=>{e.showAnswer()})))}),1e3)})),C((async()=>{await V(),b.value.includes("analysis")||(window.history.pushState(null,"",document.URL),window.addEventListener("popstate",D,!1))})),L((()=>{window.removeEventListener("popstate",D,!1)})),T((async()=>{await(async()=>{if(I({title:"加载中！"}),"analysisFalse"==b.value){const e=await X({id:h.value});m.value=e.filter((e=>0==e.is_true)),console.log(m.value)}else m.value=await X({id:h.value});if("answer"==b.value){const e=m.value.findIndex((e=>!e.hasOwnProperty("user_answer")));s.value=-1==e?0:e}O()})()})),(e,a)=>{const t=y,d=P;return u(),n(t,{class:"flex flex-col h-[100vh]"},{default:i((()=>[r(t,{class:"p-[30rpx] flex items-center justify-between"},{default:i((()=>[r(t,{class:"text-xs text-primary"},{default:i((()=>{var e;return[o(c(1==(null==(e=m.value[s.value])?void 0:e.type)?"单选":"多选"),1)]})),_:1}),r(t,{onClick:B},{default:i((()=>[r(d,{class:"text-primary"},{default:i((()=>[o(c(s.value+1),1)])),_:1}),r(d,{class:"text-xs text-info"},{default:i((()=>[o("/"+c(m.value.length),1)])),_:1})])),_:1})])),_:1}),r(t,{class:"flex-1 min-h-0",onTouchstart:U,onTouchmove:R,onTouchcancel:S,onTouchend:S},{default:i((()=>[(u(!0),v(_,null,p(m.value,((e,a)=>(u(),n(q,{key:a,ref_for:!0,ref_key:"itemRef",ref:l,class:x({" hidden":a!=s.value}),modelValue:m.value[a],"onUpdate:modelValue":e=>m.value[a]=e,"is-last":a+1==m.value.length,onToNext:$},null,8,["class","modelValue","onUpdate:modelValue","is-last"])))),128))])),_:1})])),_:1})}}}),[["__scopeId","data-v-da5609d8"]]);export{B as default};
