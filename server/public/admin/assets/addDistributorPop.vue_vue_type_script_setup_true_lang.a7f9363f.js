import{P as q}from"./index.ef2d2188.js";import{c as X,B as Y,C as N,D as j,M as z,b as K,L as M,O as G,w as H,T as J,S as Z}from"./element-plus.46c04e86.js";import{b as ee,g as te}from"./distributor.a87a429c.js";import{r as oe,f as T}from"./index.9967fbd7.js";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang.9b41a941.js";import{u as ae}from"./usePaging.92ba177b.js";import{d as Q,e as ne,s as w,r as V,af as ue,o as p,O as h,P as t,a as s,X as e,u as g,Q as se,W as f,V as C,k as re,U as ie,c as ce,a8 as _e,Y as de}from"./@vue.6265a5d9.js";function me(y){return oe.get({url:"/user.user/lists",params:y})}const pe={class:"flex items-center"},fe={class:"ml-2"},ve={class:"flex justify-end mt-4"},be=Q({__name:"index",props:{modelValue:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(y,{expose:P,emit:k}){const B=y,d=ne({get(){return B.modelValue},set(o){k("update:modelValue",o)}}),m=w(),a=w(),i=V({keyword:"",isDistribution:0}),F=async()=>{await a.value.clearSelection(),c.lists.forEach(o=>{d.value.forEach(u=>{o.id==u.id&&a.value.toggleRowSelection(o,!0)})})},D=async()=>{await m.value.open(),await F(),v()},R=o=>o.id,U=()=>{d.value=a.value.getSelectionRows(),m.value.close()},{pager:c,getLists:v,resetPage:O,resetParams:b}=ae({fetchFun:me,params:i.value});return P({open:D}),(o,u)=>{const _=ue("Search"),L=X,S=Y,E=N,I=j,r=z,A=K,$=M,l=le,x=q,W=G;return p(),h(x,{title:"\u9009\u62E9\u7528\u6237",ref_key:"popRef",ref:m,width:"auto",async:"",onConfirm:U},{default:t(()=>[s("view",null,[e(I,null,{default:t(()=>[e(E,{label:"\u641C\u7D22\u7528\u6237"},{default:t(()=>[e(S,{modelValue:i.value.keyword,"onUpdate:modelValue":u[0]||(u[0]=n=>i.value.keyword=n),class:"w-[240px]",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",onInput:g(v)},{append:t(()=>[e(L,null,{default:t(()=>[e(_)]),_:1})]),_:1},8,["modelValue","onInput"])]),_:1})]),_:1}),s("div",null,[se((p(),h($,{ref_key:"tableRef",ref:a,size:"large",data:g(c).lists,class:"mt-4",height:"400px","row-key":R},{default:t(()=>[e(r,{"reserve-selection":"",type:"selection",width:"55"}),e(r,{label:"\u7528\u6237\u8D26\u53F7",prop:"sn","min-width":"120"}),e(r,{label:"\u7528\u6237\u6635\u79F0","min-width":"180"},{default:t(({row:n})=>[s("div",pe,[e(A,{class:"w-[48px] h-[48px] flex-none",src:n.avatar},null,8,["src"]),s("div",fe,f(n.nickname),1)])]),_:1}),e(r,{label:"\u7528\u6237\u4F59\u989D","min-width":"120"},{default:t(({row:n})=>[s("div",null,"\xA5"+f(n.user_money),1)]),_:1}),e(r,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile","min-width":"120"},{default:t(({row:n})=>[C(f(n.mobile||"-"),1)]),_:1}),e(r,{label:"\u5206\u9500\u5546","min-width":"120"},{default:t(({row:n})=>[C(f(n.is_distributor==0?"\u5426":"\u662F"),1)]),_:1}),e(r,{label:"\u6CE8\u518C\u65F6\u95F4",prop:"create_time","min-width":"180"})]),_:1},8,["data"])),[[W,g(c).loading]]),s("div",ve,[e(l,{modelValue:g(c),"onUpdate:modelValue":u[1]||(u[1]=n=>re(c)?c.value=n:null),onChange:g(v)},null,8,["modelValue","onChange"])])])])]),_:1},512)}}}),ge={class:"flex-none w-full"},we=C("\u9009\u62E9\u7528\u6237"),he={class:"flex items-center"},ye={class:"ml-2"},ke=C("\u79FB\u9664"),De=Q({__name:"addDistributorPop",emits:["close","confirm"],setup(y,{expose:P,emit:k}){const B=w(),d=w(),m=w(),a=V([]),i=V(),F=V([]),D=()=>{d.value.open(),O()},R=()=>{m.value.open()},U=()=>{k("close")},c=async()=>{if(!i.value)return T.msgError("\u8BF7\u9009\u62E9\u5206\u9500\u7B49\u7EA7");if(!a.value.length)return T.msgError("\u8BF7\u9009\u62E9\u5206\u9500\u7528\u6237");const b=a.value.map(o=>o.id);await ee({user_ids:b,level_id:i.value}),k("confirm"),d.value.close()},v=b=>{const o=a.value.findIndex(u=>u.id==b.id);a.value.splice(o,1)},O=async()=>{F.value=await te()};return P({open:D}),(b,o)=>{const u=H,_=z,L=K,S=M,E=N,I=Z,r=J,A=j,$=q;return p(),h($,{ref_key:"popRef",ref:d,title:"\u5F00\u901A\u5206\u9500\u5546",width:"700px",onClose:U,async:"",onConfirm:c},{default:t(()=>[e(A,{ref_key:"formRef",ref:B},{default:t(()=>[e(E,{label:"\u7528\u6237\u4FE1\u606F",class:"is-required"},{default:t(()=>[s("div",ge,[e(u,{type:"primary",onClick:R},{default:t(()=>[we]),_:1}),a.value.length!=0?(p(),h(S,{key:0,class:"mt-4",data:a.value},{default:t(()=>[e(_,{label:"\u7528\u6237\u7F16\u7801",prop:"sn"}),e(_,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname","min-width":"120"},{default:t(({row:l})=>[s("div",he,[e(L,{class:"w-[47px] h-47px flex-none",src:l.avatar},null,8,["src"]),s("div",ye,f(l.nickname),1)])]),_:1}),e(_,{label:"\u5206\u9500\u5546"},{default:t(({row:l})=>[s("div",null,f(l.is_distribution==0?"\u5426":"\u662F"),1)]),_:1}),e(_,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile"}),e(_,{label:"\u64CD\u4F5C"},{default:t(({row:l})=>[e(u,{type:"primary",onClick:x=>v(l),link:""},{default:t(()=>[ke]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):ie("",!0)])]),_:1}),e(E,{label:"\u5206\u9500\u7B49\u7EA7",class:"is-required"},{default:t(()=>[e(r,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=l=>i.value=l)},{default:t(()=>[(p(!0),ce(de,null,_e(F.value,(l,x)=>(p(),h(I,{key:x,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},512),e(be,{ref_key:"userPickerPop",ref:m,modelValue:a.value,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value=l)},null,8,["modelValue"])]),_:1},512)}}});export{De as _};
