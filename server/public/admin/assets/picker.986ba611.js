import{P as E}from"./index.ef2d2188.js";import{E as K}from"./element-plus.46c04e86.js";import{F as Q,_ as F,a as X}from"./index.90219876.js";import{u as j,d as q,b as G}from"./index.9967fbd7.js";import{_ as H}from"./index.850e3705.js";import{D as J}from"./vuedraggable.3b18617e.js";import{d as O,r as s,ab as W,e as S,w as Y,E as P,n as Z,af as U,o as k,c as V,X as i,a9 as x,P as m,a as n,S as I,$ as B,U as ee,Q as ae,R as le,K as te,a0 as oe,V as se,b7 as ie,b6 as ne}from"./@vue.6265a5d9.js";const ue=O({components:{Popup:E,Draggable:J,FileItem:Q,Material:F,Preview:X},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1},getName:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:t}){const _=s(),g=s(),y=s(""),w=s(!1),l=s([]),c=s([]),r=s([]),u=s(!0),f=s(-1),{disabled:C,limit:d,modelValue:b}=W(e),{getImageUrl:o}=j(),v=S(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";case"audio":return"\u97F3\u9891";case"file":return"\u538B\u7F29\u6587\u4EF6";default:return""}}),h=S(()=>e.limit-l.value.length>0),A=S(()=>u.value?d.value==-1?null:d.value-l.value.length:1),N=()=>{const a=r.value.map(p=>e.excludeDomain?p.url:p.uri);c.value=r.value,u.value?l.value=[...l.value,...a]:l.value.splice(f.value,1,a.shift()),$()},R=a=>{var p;C.value||(a>=0?(u.value=!1,f.value=a):u.value=!0,(p=_.value)==null||p.open())},L=a=>{r.value=a},$=()=>{const a=d.value!=1?l.value:l.value[0]||"";t("update:modelValue",a),t("change",a,c.value),z()},T=a=>{l.value.splice(a,1),$()},M=a=>{a=e.excludeDomain?o(a):a,y.value=a,w.value=!0},z=()=>{Z(()=>{var a;e.hiddenUpload&&(l.value=[]),(a=g.value)==null||a.clearSelect()})};return Y(b,a=>{l.value=Array.isArray(a)?a:a==""?[]:[a]},{immediate:!0}),P("limit",e.limit),P("hiddenUpload",e.hiddenUpload),{popupRef:_,materialRef:g,fileList:l,tipsText:v,handleConfirm:N,meterialLimit:A,showUpload:h,showPopup:R,selectChange:L,deleteImg:T,previewUrl:y,showPreview:w,handlePreview:M,handleClose:z,getImageUrl:o}}});const D=e=>(ie("data-v-733a64ff"),e=e(),ne(),e),re={class:"material-select"},de=["onClick"],pe={key:0,class:"operation-btns text-xs text-center"},me=D(()=>n("span",null,"\u4FEE\u6539",-1)),ce=se(" | "),fe=["onClick"],ve=D(()=>n("span",null,"\u6DFB\u52A0",-1)),he={class:"material-wrap"};function _e(e,t,_,g,y,w){const l=U("file-item"),c=H,r=U("draggable"),u=G,f=F,C=K,d=E,b=U("preview");return k(),V("div",re,[i(d,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},x({default:m(()=>[i(C,null,{default:m(()=>[n("div",he,[i(f,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:m(()=>[n("div",{class:"material-select__trigger clearfix",onClick:t[1]||(t[1]=B(()=>{},["stop"]))},[i(r,{class:"draggable",list:e.fileList,animation:"300","item-key":"id"},{item:m(({element:o,index:v})=>[n("div",{class:I(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:h=>e.showPopup(v)},[i(c,{onClose:h=>e.deleteImg(v)},{default:m(()=>[i(l,{uri:e.excludeDomain?e.getImageUrl(o):o,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),e.type!="file"?(k(),V("div",pe,[me,ce,n("span",{onClick:B(h=>e.handlePreview(o),["stop"])},"\u67E5\u770B",8,fe)])):ee("",!0)],10,de)]),_:1},8,["list"]),ae(n("div",{class:I(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:t[0]||(t[0]=o=>e.showPopup(-1))},[te(e.$slots,"upload",{},()=>[n("div",{class:"upload-btn",style:oe({width:e.size,height:e.size})},[i(u,{size:25,name:"el-icon-Plus"}),ve],4)],!0)],2),[[le,e.showUpload]])])])}]),1032,["title","onConfirm","onClose"]),i(b,{modelValue:e.showPreview,"onUpdate:modelValue":t[2]||(t[2]=o=>e.showPreview=o),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const $e=q(ue,[["render",_e],["__scopeId","data-v-733a64ff"]]);export{$e as _};
